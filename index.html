<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Musa Soko - Video Editor & Motion Designer</title>
    <!-- ADD p5.js LIBRARY -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --bg-color: #0a0a0a;
        --text-color: #e0e0e0;
        --card-bg: rgba(20, 20, 20, 0.95);
        --header-bg: #000;
        --button-bg: #4a86e8;
        --accent-color: #4a86e8;
        --transition: all 0.3s ease;
        --nav-color: #151522;
      }

      body {
        font-family: "Roboto", sans-serif;
        background: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        overflow-x: hidden;
      }

      html {
        scroll-behavior: smooth;
      }

      /* ============================================= */
      /* PARTICLE SYSTEM STYLES FROM TEST INTEGRATION */
      /* ============================================= */

      /* Canvas for particles */
      #particle-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
      }

      /* Particle Toggle Button - TOP RIGHT */

      /* ============================================= */
      /* PARTICLE TOGGLE BUTTON - TO SHOW/HIDE BUTTON: */
      /* Change 'display: block' to 'display: none' to hide */
      /* Change 'display: none' to 'display: block' to show */
      /* ============================================= */
      .particle-toggle {
        position: fixed;
        top: 90px; /* Positioned below navbar */
        right: 20px;
        z-index: 1000;
        background: var(--button-bg);
        color: white;
        border: none;
        padding: 12px 18px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: var(--transition);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        font-family: "Montserrat", sans-serif;
        font-weight: 600;
        display: none; /* Change to 'none' to hide the button */
      }

      .particle-toggle:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
        background: #ff4444;
      }

      .particle-toggle.off {
        background: #666;
      }

      .particle-toggle.off:hover {
        background: #4a86e8;
      }

      /* ============================================= */
      /* EXISTING PORTFOLIO STYLES - UNCHANGED */
      /* ============================================= */

      /* Navigation */
      .navbar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: var(--nav-color);
        z-index: 1000;
        padding: 1rem 0;
        transition: var(--transition);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .navbar.hidden {
        transform: translateY(-100%);
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 2rem;
      }

      .nav-logo {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--accent-color);
        text-decoration: none;
      }

      .nav-menu {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        gap: 2rem;
      }

      .nav-link {
        color: var(--text-color);
        text-decoration: none;
        font-size: 1rem;
        transition: var(--transition);
        position: relative;
        font-weight: 500;
      }

      .nav-link:hover {
        color: var(--accent-color);
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--accent-color);
        transition: var(--transition);
      }

      .nav-link:hover::after {
        width: 100%;
      }

      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 1.5rem;
        cursor: pointer;
      }

      /* Background decorations - Only dark mode */
      .bg-decorations {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: -1;
        opacity: 0.3;
      }

      .abstract-shapes {
        position: absolute;
        width: 100%;
        height: 100%;
      }

      .abstract-shape {
        position: absolute;
        opacity: 0.4;
        transition: transform 1s ease, opacity 0.5s ease;
      }

      @keyframes shatter {
        0% {
          transform: translate(0, 0) rotate(0) scale(1);
          opacity: 0.4;
        }
        50% {
          opacity: 0.2;
        }
        100% {
          transform: translate(var(--tx), var(--ty)) rotate(var(--r)) scale(0);
          opacity: 0;
        }
      }

      .shatter {
        animation: shatter 1.5s forwards;
      }

      /* Header */
      header {
        background: var(--header-bg);
        color: var(--text-color);
        padding: 8rem 2rem 4rem;
        text-align: left;
        position: relative;
        z-index: 10;
        min-height: 60vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        padding-left: 4rem;
      }

      header h1 {
        margin: 0;
        font-size: 4rem;
        animation: fadeInUp 1s ease;
        font-family: "Montserrat", sans-serif;
      }

      header p {
        margin: 0rem 0 4rem;
        font-size: 1.5rem;
        color: #aaa;
        max-width: 600px;
        animation: fadeInUp 1s ease 0.2s forwards;
        opacity: 0;
      }

      .header-cta {
        animation: fadeInUp 1s ease 0.4s forwards;
        opacity: 0;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Sections */
      section {
        padding: 5rem 2rem;
        max-width: 1200px;
        margin: auto;
        position: relative;
        z-index: 10;
      }

      section h2 {
        text-align: center;
        margin-bottom: 3rem;
        font-size: 2.5rem;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        font-family: "Montserrat", sans-serif;
      }

      section h2::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 4px;
        background: var(--accent-color);
        border-radius: 2px;
      }

      /* FIXED: Video containers with proper sizing and glow */
      .video-container {
        display: flex;
        justify-content: center;
        margin-bottom: 2rem;
        border-radius: 12px;
        overflow: visible; /* Changed from hidden to visible for glow */
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transition: var(--transition);
        border: 2px solid transparent;
        position: relative;
        /* Restore original sizing but with proper containment */
        width: 100%;
        max-width: 900px;
        margin-left: auto;
        margin-right: auto;
      }

      .video-container:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(74, 134, 232, 0.3), 0 0 20px rgba(74, 134, 232, 0.5);
      }

      .video-wrapper {
        width: 100%;
        border-radius: 12px;
        overflow: hidden; /* Contain the iframe here instead */
        position: relative;
      }

      .video-container iframe {
        width: 100%;
        max-width: 900px;
        aspect-ratio: 16/9;
        border: none;
        border-radius: 12px;
        display: block;
      }

      /* Projects section */
      .project-filters {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .filter-btn {
        padding: 0.5rem 1.5rem;
        background: transparent;
        color: var(--text-color);
        border: 2px solid var(--accent-color);
        border-radius: 50px;
        cursor: pointer;
        transition: var(--transition);
      }

      .filter-btn:hover,
      .filter-btn.active {
        background: var(--accent-color);
        color: white;
      }

      .projects {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2.5rem;
        margin-top: 2rem;
      }

      .project {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        transition: var(--transition);
        border: 1px solid rgba(255, 255, 255, 0.1);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 0.6s ease forwards;
      }

      .project:nth-child(1) {
        animation-delay: 0.1s;
      }
      .project:nth-child(2) {
        animation-delay: 0.2s;
      }
      .project:nth-child(3) {
        animation-delay: 0.3s;
      }
      .project:nth-child(4) {
        animation-delay: 0.4s;
      }

      .project:hover {
        transform: translateY(-10px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15),
          0 0 15px rgba(0, 136, 255, 0.4);
      }

      .project-video {
        width: 100%;
        height: 250px;
        background: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        cursor: pointer;
        transition: var(--transition);
        border-bottom: 3px solid var(--accent-color);
      }

      .project-video:hover {
        box-shadow: 0 0 20px rgba(0, 136, 255, 0.6);
      }

      .ribbon-overlay {
        position: absolute;
        top: -100%;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.7;
        z-index: 2;
        transition: top 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      .project-video:hover .ribbon-overlay {
        top: 0;
      }

      .project-video::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.3);
        opacity: 0;
        transition: var(--transition);
        z-index: 1;
      }

      .project-video:hover::before {
        opacity: 1;
      }

      .project-video::after {
        content: "▶";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 3rem;
        color: white;
        opacity: 0;
        transition: var(--transition);
        z-index: 3;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
      }

      .project-video:hover::after {
        opacity: 0.8;
      }

      .video-placeholder {
        color: white;
        text-align: center;
        font-size: 1.1rem;
        padding: 1rem;
        background: rgba(0, 91, 133, 0.7);
        border-radius: 8px;
        z-index: 1;
      }

      .project-video video,
      .project-video iframe {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border: none;
        transition: var(--transition);
      }

      /* Enhanced project layout classes */
      .project.portrait-layout,
      .project.square-layout {
        max-width: 400px;
        justify-self: center;
        transition: all 0.5s ease;
      }

      .project.landscape-layout {
        max-width: none;
        justify-self: stretch;
        transition: all 0.5s ease;
      }

      /* Enhanced projects grid */
      .projects {
        align-items: start;
      }

      /* Loading state */
      .project-video.loading {
        background: #333;
      }

      .project-video.loading::after {
        content: "Loading...";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 1rem;
        z-index: 5;
      }

      /* Hide overlays when playing */
      .project-video.playing .ribbon-overlay,
      .project-video.playing::before,
      .project-video.playing::after {
        display: none !important;
      }

      .project-video.playing .video-placeholder,
      .project-video.playing .thumbnail-container {
        display: none !important;
      }

      /* Enhanced portrait mode */
      .project-video.portrait-mode {
        background: #000;
        border-radius: 8px;
        max-width: 400px;
        aspect-ratio: 9 / 16;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .project-video.portrait-mode iframe,
      .project-video.portrait-mode video {
        width: 100%;
        height: 100%;
        object-fit: contain;
        border-radius: 8px;
      }

      @media (max-width: 768px) {
        .project-video.portrait-mode {
          height: 350px;
          width: 250px;
        }
      }

      /* Enhanced landscape mode */
      .project-video.landscape-mode {
        background: #000;
        border-radius: 8px;
      }

      /* Square mode */
      .project-video.square-mode {
        background: #000;
        border-radius: 8px;
        height: 350px;
        width: 350px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .project-video.square-mode iframe,
      .project-video.square-mode video {
        object-fit: contain !important;
        border-radius: 8px;
        width: 100% !important;
        height: 100% !important;
      }

      @media (max-width: 768px) {
        .project-video.square-mode {
          height: 250px;
          width: 250px;
        }
      }

      .project-video.landscape-mode iframe,
      .project-video.landscape-mode video {
        object-fit: cover !important;
        border-radius: 8px;
      }

      /* New styles for video playback within project container */
      .project-video.playing {
        cursor: default;
        transition: all 0.5s ease;
      }

      .project-video.playing .ribbon-overlay,
      .project-video.playing::before,
      .project-video.playing::after {
        display: none;
      }

      .project-video.playing .video-placeholder {
        display: none;
      }

      .project-video.playing video {
        object-fit: contain;
        transform: none !important;
      }

      .video-controls {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .project-video {
        position: relative;
        background: #333;
      }

      .thumbnail-container {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        position: absolute;
        top: 0;
        left: 0;
        overflow: hidden;
      }

      .video-thumbnail {
        max-width: 130%;
        max-height: 130%;
        width: auto;
        height: auto;
        object-fit: contain;
      }

      .project-video.playing .play-button {
        display: none;
      }

      .project-video.playing .video-thumbnail {
        display: none;
      }

      .project-video video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: none;
      }

      .project-video.playing video {
        display: block;
      }

      .project-video.playing .video-controls {
        opacity: 1;
      }

      .video-controls button {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 4px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 12px;
      }

      .video-controls button:hover {
        background: rgba(0, 0, 0, 0.9);
      }

      .project-info {
        padding: 1.5rem;
      }

      .project-info h3 {
        margin: 0 0 0.5rem 0;
        font-size: 1.3rem;
        color: var(--text-color);
      }

      .project-info .project-type {
        color: var(--accent-color);
        font-size: 0.9rem;
        margin-bottom: 1rem;
        font-weight: 600;
        display: inline-block;
        padding: 0.3rem 0.8rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }

      .project-info p {
        margin: 0;
        color: #ccc;
        line-height: 1.5;
      }

      .project-video.error {
        background: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
      }

      .project-video.error::after {
        content: "Video unavailable";
        font-size: 1rem;
        color: #999;
      }

      a.button {
        display: inline-block;
        padding: 0.8rem 1.5rem;
        background: var(--button-bg);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        margin-top: 1rem;
        transition: var(--transition);
        border: 2px solid transparent;
      }

      a.button:hover {
        background: transparent;
        border-color: var(--button-bg);
        color: white;
      }

      .skills-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .skill-category {
        background: var(--card-bg);
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .skill-category h3 {
        margin-top: 0;
        color: var(--accent-color);
        text-align: center;
      }

      .skill-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        justify-content: center;
      }

      .skill-tag {
        padding: 0.4rem 0.8rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50px;
        font-size: 0.9rem;
      }

      footer {
        text-align: center;
        padding: 3rem 2rem;
        background: var(--header-bg);
        color: #aaa;
        margin-top: 3rem;
      }

      .social-links {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin: 1.5rem 0;
      }

      .social-link {
        color: #aaa;
        font-size: 1.5rem;
        transition: var(--transition);
        text-decoration: none;
      }

      .social-link:hover {
        color: var(--accent-color);
        transform: translateY(-3px);
      }

      /* Aspect ratio detection and responsive layout */
      .project-video.playing.portrait-mode {
        grid-column: 1 / -1;
        width: 100%;
        max-width: 400px;
        margin: 0 auto;
        justify-self: center;
      }

      @media (max-width: 768px) {
        header {
          padding: 6rem 1rem 3rem;
          min-height: 50vh;
        }

        header h1 {
          font-size: 2.5rem;
        }

        header p {
          font-size: 1.2rem;
        }

        .navbar {
          padding: 0.8rem 0;
        }

        .nav-container {
          padding: 0 1rem;
        }

        .nav-menu {
          gap: 1rem;
        }

        section {
          padding: 3rem 1rem;
        }

        .projects {
          grid-template-columns: 1fr;
          gap: 1.5rem;
        }

        .project-video {
          height: 200px;
        }

        .project-video.portrait {
          height: 300px;
        }

        .project-video.portrait .video-thumbnail {
          max-width: 70%;
          max-height: 85%;
        }

        .skills-container {
          grid-template-columns: 1fr;
        }

        .video-controls {
          bottom: 5px;
        }

        .video-controls button {
          padding: 3px 8px;
          font-size: 10px;
        }

        /* Mobile adjustments for portrait videos */
        .project-video.playing.portrait-mode {
          max-width: 300px;
        }

        /* Mobile adjustments for video containers */
        .video-container {
          max-width: 100%;
        }

        .video-container iframe {
          max-width: 100%;
        }

        /* HIDE PARTICLE TOGGLE ON MOBILE */
        .particle-toggle {
          display: none !important;
        }

        /* HIDE PARTICLE CANVAS ON MOBILE */
        #particle-canvas {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- ============================================= -->
    <!-- PARTICLE SYSTEM ELEMENTS FROM TEST INTEGRATION -->
    <!-- ============================================= -->

    <!-- Particle Canvas -->
    <div id="particle-canvas"></div>

    <!-- Particle Toggle Button - TOP RIGHT -->
    <button
      class="particle-toggle"
      id="particleToggle"
      title="Toggle Particle Effects"
    >
      🔥 Particles: ON
    </button>

    <!-- ============================================= -->
    <!-- EXISTING PORTFOLIO CONTENT - UNCHANGED -->
    <!-- ============================================= -->

    <!-- Navigation -->
    <nav class="navbar">
      <div class="nav-container">
        <a href="#" class="nav-logo">Musa Soko</a>
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
          &#9776;
        </button>
        <ul class="nav-menu">
          <li><a href="#showreel" class="nav-link">Showreel</a></li>
          <li><a href="#projects" class="nav-link">Projects</a></li>
          <li><a href="#skills" class="nav-link">Skills</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
          <li><a href="#contact" class="nav-link">Contact</a></li>
        </ul>
      </div>
    </nav>

    <!-- Background decorations - Only dark mode -->
    <div class="bg-decorations">
      <div class="abstract-shapes">
        <!-- Asteroids will be generated dynamically with JavaScript -->
      </div>
    </div>

    <!-- Header -->
    <header>
      <h1>Hi I'm Musa Soko</h1>
      <p>a Video Editor and Motion Graphic Designer based in South Africa</p>
      <div class="header-cta">
        <a href="#projects" class="button">View My Work</a>
      </div>
    </header>

    <section id="showreel">
      <h2>Showreel</h2>
      <div class="video-container">
        <div class="video-wrapper">
          <iframe
            src="https://player.vimeo.com/video/1108056464"
            allowfullscreen
          ></iframe>
        </div>
      </div>
    </section>

    <section id="highlight">
      <h2>Highlight Reel - Winedrops</h2>
      <div class="video-container">
        <div class="video-wrapper">
          <iframe
            src="https://player.vimeo.com/video/1109940880"
            allowfullscreen
          ></iframe>
        </div>
      </div>
      <div class="video-placeholder">
        A focused edit showcasing my recent work with Winedrops, including ads,
        YouTube content, and social media videos.
      </div>
    </section>

    <!-- Rest of your HTML remains the same -->
    <section id="projects">
      <h2>Selected Projects</h2>

      <div class="project-filters">
        <button class="filter-btn active" data-filter="all">All</button>
      </div>

      <div class="projects">
        <!-- PROJECT 1 - Horizontal Video Example -->
        <div
          class="project"
          data-category="commercial"
          id="project-container-1"
        >
          <div
            class="project-video"
            data-video="https://vimeo.com/1114326040"
            data-aspect-ratio="landscape"
          >
            <div class="thumbnail-container">
              <img
                src="images/Realistic Strategist.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #45b7d1, #6bd1e8)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Website Info Video</h3>
            <p>
              A video created for Realistic Strategist's website Info section,
              showcasing their digital marketing brand with clean edits and
              smooth motion graphics to highlight key services.
            </p>
          </div>
        </div>

        <!-- PROJECT 2 - Horizontal Video Example -->
        <div class="project" data-category="social" id="project-container-2">
          <div
            class="project-video"
            data-video="https://vimeo.com/1114454162"
            data-aspect-ratio="landscape"
          >
            <div class="thumbnail-container">
              <img
                src="images/Youtube img.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #f7dc6f, #f9e79f)"
            ></div>
          </div>
          <div class="project-info">
            <h3>YouTube Video Edit</h3>
            <p>
              Exploring whether boiling or freezing Sassicaia wine changes its
              taste.
            </p>
          </div>
        </div>

        <!-- PROJECT 3 - Another portrait Video -->
        <div class="project" data-category="youtube" id="project-container-3">
          <div
            class="project-video"
            data-video="https://vimeo.com/1121611979"
            data-aspect-ratio="portrait"
          >
            <div class="thumbnail-container">
              <img
                src="images/Strive Content.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #ff0000, #d1e6ff)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Social Media Content</h3>
            <p>
              Produced motion graphics explainer to educate audiences on email
              technology.
            </p>
          </div>
        </div>

        <!-- PROJECT 4 - Add more projects as needed -->
        <div class="project" data-category="motion" id="project-container-4">
          <div
            class="project-video"
            data-video="https://vimeo.com/900842265"
            data-aspect-ratio="portrait"
          >
            <div class="thumbnail-container">
              <img
                src="images/Mortica.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #d6a458, #e082ae)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Personal Project</h3>
            <p>
              This was a collaborative personal project with a musician friend
              after finishing our studies. He composed the music while I
              designed the visuals.
            </p>
          </div>
        </div>

        <!-- PROJECT - Square Video Example -->
        <div class="project" data-category="social" id="project-container-5">
          <div
            class="project-video"
            data-video="https://vimeo.com/1114326897?share=copy"
            data-aspect-ratio="square"
          >
            <div class="thumbnail-container">
              <img
                src="images/sales source.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #3f3ce7, #ac12f3)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Social Media Ad</h3>
            <p>A spec project for SalesSource, a digital marketing brand.</p>
          </div>
        </div>

        <!-- PROJECT 6 - Another portrait Video -->
        <div class="project" data-category="youtube" id="project-container-6">
          <div
            class="project-video"
            data-video="https://vimeo.com/1114453751"
            data-aspect-ratio="portrait"
          >
            <div class="thumbnail-container">
              <img
                src="images/Short ad.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #10a0ff, #bde2e2)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Social Media Ad</h3>
            <p>
              A short social media ad for Winedrops showcasing their wine
              delivery and digital services.
            </p>
          </div>
        </div>

        <!-- PROJECT 7 - Another portrait Video -->
        <div class="project" data-category="youtube" id="project-container-7">
          <div
            class="project-video"
            data-video="https://vimeo.com/1121503730"
            data-aspect-ratio="portrait"
          >
            <div class="thumbnail-container">
              <img
                src="images/Strivetech.jpg"
                class="video-thumbnail"
                alt="Video thumbnail"
              />
            </div>
            <div
              class="ribbon-overlay"
              style="background: linear-gradient(135deg, #ff104c, #e2c4bd)"
            ></div>
          </div>
          <div class="project-info">
            <h3>Brand Identity</h3>
            <p>
              Developed motion style, color palette, and visual identity
              concepts for StriveTech's brand.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="skills">
      <h2>Skills & Software</h2>
      <div class="skills-container">
        <div class="skill-category">
          <h3>Editing</h3>
          <div class="skill-list">
            <span class="skill-tag">Adobe Premiere Pro</span>
            <span class="skill-tag">Color Grading</span>
            <span class="skill-tag">Audio Editing</span>
          </div>
        </div>

        <div class="skill-category">
          <h3>Motion Graphics</h3>
          <div class="skill-list">
            <span class="skill-tag">After Effects</span>
            <span class="skill-tag">Blender</span>
            <span class="skill-tag">2D Animation</span>
            <span class="skill-tag">3D Animation</span>
          </div>
        </div>

        <div class="skill-category">
          <h3>Other</h3>
          <div class="skill-list">
            <span class="skill-tag">Visual Effects</span>
            <span class="skill-tag">Storyboarding</span>
            <span class="skill-tag">Sound Design</span>
            <span class="skill-tag">Photoshop</span>
          </div>
        </div>
      </div>
    </section>

    <section id="about">
      <h2>About Me</h2>
      <p style="text-align: center; max-width: 700px; margin: auto">
        Hi! I'm a video editor and motion designer. I make videos that feel fun
        to watch, whether it's for ads, social posts, or longer stories. I like
        experimenting with styles and motion to find what fits best. Outside of
        editing, I'm always curious about art, and animation.
      </p>
    </section>

    <section id="contact">
      <h2>Get In Touch</h2>
      <p style="text-align: center; max-width: 700px; margin: auto">
        Interested in working together? Have a project in mind? Feel free to
        reach out and let's create something amazing.
      </p>
      <div style="text-align: center; margin-top: 2rem">
        <a href="mailto:musasoko19@gmail.com" class="button">Send an Email</a>
      </div>
      <p
        style="
          font-size: large;
          text-align: center;
          margin: 1rem;
          color: #00aeff;
        "
      >
        musasoko19@gmail.com
      </p>
    </section>

    <footer>
      <div class="social-links">
        <a
          href="https://www.instagram.com/grandmama_patrick/"
          class="social-link"
          ><i class="fab fa-instagram"></i
        ></a>
        <a href="#" class="social-link"><i class="fab fa-vimeo-v"></i></a>
        <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
        <a href="#" class="social-link"><i class="fab fa-linkedin-in"></i></a>
      </div>
      <p>Musa Soko. "I make frames move".</p>
    </footer>

    <!-- ============================================= -->
    <!-- PARTICLE SYSTEM JAVASCRIPT FROM TEST INTEGRATION -->
    <!-- ============================================= -->
    <script>
      // =============================================
      // PARTICLE SYSTEM INTEGRATION
      // =============================================
      let particles = [];
      let containers = [];
      let hoveredContainer = null; // Track which specific container is hovered
      let particlesEnabled = true; // Track if particles are enabled

      // =============================================
      // PARTICLE COUNT SETTING - CHANGED TO 900 AS REQUESTED
      // =============================================
      const DENSITY = 900; // ⬅️ CHANGED TO 900 AS REQUESTED

      const CONFETTI_SCALE = 0.28;
      let PARTICLE_SPEED = 0.2; // HARDCODED: 0.2

      const NEUTRAL_COLOR = [88, 88, 88, 170];
      const ATTRACT_COLOR = [255, 255, 255, 220];
      const STICKY_COLOR = [180, 220, 255, 240];
      const EMITTED_COLOR = [255, 215, 0, 200];
      const BUTTON_ATTRACT_COLOR = [255, 50, 50, 220]; // Red color for button attraction
      const BUTTON_STICKY_COLOR = [255, 100, 100, 240]; // Red sticky color for button

      let colors = {};
      let attractedParticles = 0;
      let stuckParticles = 0;
      let emittedParticles = 0;
      let lastEmissionTime = 0;

      // Button container
      let buttonContainer = null;

      // HARDCODED SETTINGS - No longer using sliders
      const settings = {
        attractRadius: 96.0, // HARDCODED: 96.0
        attractStrength: 1.2, // HARDCODED: 1.2
        stickinessDistance: 1.6, // HARDCODED: 1.6
        stickinessStrength: 0.6, // HARDCODED: 0.6
        emissionRate: 4.0, // HARDCODED: 4.0
        particleSpeed: 0.2, // HARDCODED: 0.2
      };

      // Check if device is mobile
      function isMobileDevice() {
        return window.innerWidth <= 768;
      }

      class Particle {
        constructor(isEmitted = false) {
          this.isEmitted = isEmitted;
          this.reset();
        }

        reset() {
          if (this.isEmitted) {
            this.spawnAtEdge();
            this.lifetime = 255;
            this.color = colors.emitted;
          } else {
            do {
              this.x = random(width);
              this.y = random(height);
            } while (this.isNearAnyContainer(80));
            this.color = colors.neutral;
          }

          this.size = random(6, 11) * CONFETTI_SCALE;
          let angle = random(TWO_PI);
          this.baseSpeed = PARTICLE_SPEED * random(0.7, 1.2);
          this.baseDx = cos(angle) * this.baseSpeed;
          this.baseDy = sin(angle) * this.baseSpeed;
          this.dx = this.baseDx;
          this.dy = this.baseDy;

          this.angle = random(TWO_PI);
          this.rotSpeed = random(-0.03, 0.03);

          this.isAttracted = false;
          this.isStuck = false;
          this.stuckTimer = 0;
          this.floatOffsetX = random(1000);
          this.floatOffsetY = random(1000);
          this.targetContainer = null;
          this.isAttractedToButton = false;
          this.buttonAttractionProgress = 0; // 0 to 1 for gradual color change
        }

        spawnAtEdge() {
          if (!hoveredContainer && !buttonContainer?.isHovered) return;

          const container = hoveredContainer || buttonContainer;
          const left = container.x - container.w / 2;
          const right = container.x + container.w / 2;
          const top = container.y - container.h / 2;
          const bottom = container.y + container.h / 2;

          const edge = floor(random(4));
          switch (edge) {
            case 0:
              this.x = random(left, right);
              this.y = top;
              break;
            case 1:
              this.x = right;
              this.y = random(top, bottom);
              break;
            case 2:
              this.x = random(left, right);
              this.y = bottom;
              break;
            case 3:
              this.x = left;
              this.y = random(top, bottom);
              break;
          }

          const pushAngle = [PI, 0, -PI / 2, PI / 2][edge];
          const pushStrength = random(0.5, 1.5);
          this.dx += cos(pushAngle) * pushStrength;
          this.dy += sin(pushAngle) * pushStrength;
        }

        isNearAnyContainer(distance) {
          return containers.some(
            (container) =>
              dist(this.x, this.y, container.x, container.y) < distance
          );
        }

        isInAttractionZone(container) {
          const margin = settings.attractRadius;
          const left = container.x - container.w / 2 - margin;
          const right = container.x + container.w / 2 + margin;
          const top = container.y - container.h / 2 - margin;
          const bottom = container.y + container.h / 2 + margin;

          return (
            this.x > left && this.x < right && this.y > top && this.y < bottom
          );
        }

        isCloseToEdge(container) {
          const edgeDistance = map(
            settings.stickinessDistance,
            0.1,
            2.0,
            40,
            5
          );
          const left = container.x - container.w / 2;
          const right = container.x + container.w / 2;
          const top = container.y - container.h / 2;
          const bottom = container.y + container.h / 2;

          return (
            (this.x > left - edgeDistance && this.x < left + edgeDistance) ||
            (this.x > right - edgeDistance && this.x < right + edgeDistance) ||
            (this.y > top - edgeDistance && this.y < top + edgeDistance) ||
            (this.y > bottom - edgeDistance && this.y < bottom + edgeDistance)
          );
        }

        getClosestEdgePoint(container) {
          const left = container.x - container.w / 2;
          const right = container.x + container.w / 2;
          const top = container.y - container.h / 2;
          const bottom = container.y + container.h / 2;

          if (
            this.x >= left &&
            this.x <= right &&
            this.y >= top &&
            this.y <= bottom
          ) {
            const distToLeft = this.x - left;
            const distToRight = right - this.x;
            const distToTop = this.y - top;
            const distToBottom = bottom - this.y;
            const minDist = min(
              distToLeft,
              distToRight,
              distToTop,
              distToBottom
            );

            if (minDist === distToLeft) return { x: left, y: this.y };
            else if (minDist === distToRight) return { x: right, y: this.y };
            else if (minDist === distToTop) return { x: this.x, y: top };
            else return { x: this.x, y: bottom };
          }

          const nearestX = constrain(this.x, left, right);
          const nearestY = constrain(this.y, top, bottom);
          const distToLeft = abs(this.x - left);
          const distToRight = abs(this.x - right);
          const distToTop = abs(this.y - top);
          const distToBottom = abs(this.y - bottom);
          const minDist = min(distToLeft, distToRight, distToTop, distToBottom);

          if (minDist === distToLeft) return { x: left, y: nearestY };
          else if (minDist === distToRight) return { x: right, y: nearestY };
          else if (minDist === distToTop) return { x: nearestX, y: top };
          else return { x: nearestX, y: bottom };
        }

        update() {
          if (!particlesEnabled) return;

          this.isAttracted = false;
          this.isStuck = false;
          this.targetContainer = null;
          this.isAttractedToButton = false;

          // Check button hover first (highest priority)
          if (
            buttonContainer?.isHovered &&
            this.isInAttractionZone(buttonContainer)
          ) {
            this.targetContainer = buttonContainer;
            this.isAttractedToButton = true;
            this.applyEdgeAttraction();
            this.isAttracted = true;

            if (this.isCloseToEdge(buttonContainer)) {
              this.applyStickiness();
              this.isStuck = true;
              this.stuckTimer++;
            } else {
              this.stuckTimer = max(0, this.stuckTimer - 1);
            }
          }
          // Then check project container hover
          else if (
            hoveredContainer &&
            this.isInAttractionZone(hoveredContainer)
          ) {
            this.targetContainer = hoveredContainer;
            this.applyEdgeAttraction();
            this.isAttracted = true;

            if (this.isCloseToEdge(hoveredContainer)) {
              this.applyStickiness();
              this.isStuck = true;
              this.stuckTimer++;
            } else {
              this.stuckTimer = max(0, this.stuckTimer - 1);
            }
          } else {
            this.returnToNatural();
            this.stuckTimer = max(0, this.stuckTimer - 2);

            if (this.isEmitted) {
              this.lifetime -= 2;
              if (this.lifetime <= 0) this.lifetime = 0;
            }
          }

          this.x += this.dx;
          this.y += this.dy;
          this.angle += this.rotSpeed;

          if (!this.isEmitted) {
            if (this.x < 0) this.x = width;
            if (this.x > width) this.x = 0;
            if (this.y < 0) this.y = height;
            if (this.y > height) this.y = 0;
          }
        }

        applyEdgeAttraction() {
          if (!this.targetContainer) return;

          const attractStrength = settings.attractStrength * 0.08;
          const edgePoint = this.getClosestEdgePoint(this.targetContainer);
          const angleToEdge = atan2(edgePoint.y - this.y, edgePoint.x - this.x);

          this.dx += cos(angleToEdge) * attractStrength;
          this.dy += sin(angleToEdge) * attractStrength;
          this.dx = constrain(this.dx, -8, 8);
          this.dy = constrain(this.dy, -8, 8);

          // Handle color transition for button attraction
          if (this.isAttractedToButton) {
            // Gradually increase red effect
            this.buttonAttractionProgress = min(
              1,
              this.buttonAttractionProgress + 0.05
            );

            // Add flickering effect for button attraction
            const flicker = sin(millis() * 0.01) * 0.2 + 0.8;
            const currentRed = lerpColor(
              colors.attract,
              colors.buttonAttract,
              this.buttonAttractionProgress
            );
            const flickeredRed = lerpColor(
              currentRed,
              color(255, 255, 255),
              0.1 * flicker
            );

            this.color = flickeredRed;
          } else {
            // Gradually return to normal colors when not attracted to button
            this.buttonAttractionProgress = max(
              0,
              this.buttonAttractionProgress - 0.02
            );

            if (this.isEmitted) {
              const brighten = map(settings.attractStrength, 0.3, 2.5, 0, 0.3);
              this.color = lerpColor(
                this.color,
                color(255, 255, 255),
                brighten
              );
            } else {
              this.color = lerpColor(this.color, colors.attract, 0.1);
            }
          }
        }

        applyStickiness() {
          if (!this.targetContainer) return;

          const stickinessStrength = settings.stickinessStrength;
          const edgePoint = this.getClosestEdgePoint(this.targetContainer);
          const stickStrength = stickinessStrength * 0.15;
          const angleToEdge = atan2(edgePoint.y - this.y, edgePoint.x - this.x);

          this.dx += cos(angleToEdge) * stickStrength;
          this.dy += sin(angleToEdge) * stickStrength;

          const floatAmount = map(stickinessStrength, 0.1, 1.5, 0.5, 0.1);
          const floatX =
            sin(millis() * 0.002 + this.floatOffsetX) * floatAmount;
          const floatY =
            cos(millis() * 0.002 + this.floatOffsetY) * floatAmount;

          this.dx += floatX;
          this.dy += floatY;

          const damping = map(stickinessStrength, 0.1, 1.5, 0.92, 0.8);
          this.dx *= damping;
          this.dy *= damping;

          const stickIntensity = map(this.stuckTimer, 0, 60, 0, 1);

          if (this.isAttractedToButton) {
            // Use red sticky colors for button
            const flicker = sin(millis() * 0.008) * 0.3 + 0.7;
            const stickyRed = lerpColor(
              colors.buttonAttract,
              colors.buttonSticky,
              stickIntensity
            );
            const flickeredRed = lerpColor(
              stickyRed,
              color(255, 255, 255),
              0.15 * flicker
            );

            this.color = flickeredRed;
          } else if (this.isEmitted) {
            this.color = lerpColor(
              this.color,
              colors.sticky,
              stickIntensity * 0.5
            );
          } else {
            this.color = lerpColor(this.color, colors.sticky, stickIntensity);
          }
        }

        returnToNatural() {
          this.dx = lerp(this.dx, this.baseDx, 0.06);
          this.dy = lerp(this.dy, this.baseDy, 0.06);

          if (!this.isEmitted) {
            this.color = lerpColor(this.color, colors.neutral, 0.08);
          }
        }

        display() {
          if (!particlesEnabled) return;

          push();
          translate(this.x, this.y);
          rotate(this.angle);

          if (this.isEmitted) {
            fill(
              red(this.color),
              green(this.color),
              blue(this.color),
              this.lifetime
            );
          } else {
            fill(this.color);
          }

          noStroke();
          rectMode(CENTER);
          rect(0, 0, this.size, this.size * 0.6, 2);
          pop();
        }
      }

      function setup() {
        // DON'T SET UP PARTICLES ON MOBILE
        if (isMobileDevice()) {
          console.log("Mobile device detected - particles disabled");
          return;
        }

        const canvas = createCanvas(windowWidth, windowHeight);
        canvas.parent("particle-canvas");

        colors.neutral = color(...NEUTRAL_COLOR);
        colors.attract = color(...ATTRACT_COLOR);
        colors.sticky = color(...STICKY_COLOR);
        colors.emitted = color(...EMITTED_COLOR);
        colors.buttonAttract = color(...BUTTON_ATTRACT_COLOR);
        colors.buttonSticky = color(...BUTTON_STICKY_COLOR);

        // Initialize containers from project elements
        initializeContainers();

        // Initialize button container
        initializeButtonContainer();

        // =============================================
        // PARTICLE CREATION - Creates particles based on DENSITY value (900)
        // =============================================
        particles = [];
        for (let i = 0; i < DENSITY; i++) {
          particles.push(new Particle(false));
        }

        // Set up hover detection
        setupHoverDetection();

        // Set up toggle button functionality
        setupToggleButton();
      }

      function initializeButtonContainer() {
        // DON'T SET UP BUTTON ON MOBILE
        if (isMobileDevice()) return;

        const buttonElement = document.getElementById("particleToggle");
        if (buttonElement) {
          const rect = buttonElement.getBoundingClientRect();
          buttonContainer = {
            element: buttonElement,
            x: rect.left + rect.width / 2,
            y: rect.top + rect.height / 2,
            w: rect.width,
            h: rect.height,
            isHovered: false,
          };
        }
      }

      function setupToggleButton() {
        // DON'T SET UP TOGGLE ON MOBILE
        if (isMobileDevice()) return;

        const toggleButton = document.getElementById("particleToggle");

        toggleButton.addEventListener("click", function () {
          particlesEnabled = !particlesEnabled;

          if (particlesEnabled) {
            this.textContent = "🔥 Silly Goober: ON";
            this.classList.remove("off");
          } else {
            this.textContent = "💤 Silly Goober: OFF";
            this.classList.add("off");
          }
        });

        // Button hover detection
        toggleButton.addEventListener("mouseenter", function () {
          if (buttonContainer) {
            buttonContainer.isHovered = true;
          }
        });

        toggleButton.addEventListener("mouseleave", function () {
          if (buttonContainer) {
            buttonContainer.isHovered = false;
          }
        });
      }

      function initializeContainers() {
        // DON'T SET UP CONTAINERS ON MOBILE
        if (isMobileDevice()) return;

        // Initialize containers for ALL project containers in your portfolio
        const projectContainers = [
          "project-container-1",
          "project-container-2",
          "project-container-3",
          "project-container-4",
          "project-container-5",
          "project-container-6",
          "project-container-7",
        ];

        projectContainers.forEach((id) => {
          const element = document.getElementById(id);
          if (element) {
            const rect = element.getBoundingClientRect();
            containers.push({
              element: element,
              x: rect.left + rect.width / 2,
              y: rect.top + rect.height / 2,
              w: rect.width,
              h: rect.height,
              id: id,
            });
          }
        });
      }

      function setupHoverDetection() {
        // DON'T SET UP HOVER DETECTION ON MOBILE
        if (isMobileDevice()) return;

        containers.forEach((container) => {
          container.element.addEventListener("mouseenter", () => {
            hoveredContainer = container; // Set the specific hovered container
          });

          container.element.addEventListener("mouseleave", () => {
            // Only clear if we're leaving the currently hovered container
            if (hoveredContainer && hoveredContainer.id === container.id) {
              hoveredContainer = null;
            }
          });
        });
      }

      function draw() {
        // DON'T DRAW PARTICLES ON MOBILE
        if (isMobileDevice()) return;

        background(25, 25, 25, 100);

        // Update container positions (in case of scroll/resize)
        updateContainerPositions();

        // Update button position
        updateButtonPosition();

        // Emit particles when a specific container is hovered and particles are enabled
        if (
          particlesEnabled &&
          (hoveredContainer || buttonContainer?.isHovered)
        ) {
          const currentTime = millis();
          if (
            currentTime - lastEmissionTime >
            1000 / (settings.emissionRate + 1)
          ) {
            for (let i = 0; i < settings.emissionRate; i++) {
              particles.push(new Particle(true));
            }
            lastEmissionTime = currentTime;
          }
        }

        // Update and count particles
        attractedParticles = 0;
        stuckParticles = 0;
        emittedParticles = 0;

        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];

          if (p.isEmitted) {
            emittedParticles++;
            if (p.lifetime <= 0) {
              particles.splice(i, 1);
              continue;
            }
          }

          p.update();

          if (p.isAttracted) attractedParticles++;
          if (p.isStuck) stuckParticles++;
        }

        // Display all particles
        for (const p of particles) {
          p.display();
        }
      }

      function updateContainerPositions() {
        // DON'T UPDATE CONTAINERS ON MOBILE
        if (isMobileDevice()) return;

        containers.forEach((container) => {
          const rect = container.element.getBoundingClientRect();
          container.x = rect.left + rect.width / 2;
          container.y = rect.top + rect.height / 2;
          container.w = rect.width;
          container.h = rect.height;
        });
      }

      function updateButtonPosition() {
        // DON'T UPDATE BUTTON ON MOBILE
        if (isMobileDevice()) return;

        if (buttonContainer) {
          const rect = buttonContainer.element.getBoundingClientRect();
          buttonContainer.x = rect.left + rect.width / 2;
          buttonContainer.y = rect.top + rect.height / 2;
          buttonContainer.w = rect.width;
          buttonContainer.h = rect.height;
        }
      }

      function windowResized() {
        // DON'T RESIZE CANVAS ON MOBILE
        if (isMobileDevice()) return;

        resizeCanvas(windowWidth, windowHeight);
      }

      // =============================================
      // EXISTING PORTFOLIO JAVASCRIPT - UNCHANGED
      // =============================================

      // Mobile menu functionality only
      function toggleMobileMenu() {
        const menu = document.querySelector(".nav-menu");
        menu.classList.toggle("active");
      }

      // Enhanced project filtering and responsive video layout
      document.addEventListener("DOMContentLoaded", function () {
        const filterButtons = document.querySelectorAll(".filter-btn");
        const projects = document.querySelectorAll(".project");

        // Project filtering functionality
        filterButtons.forEach((button) => {
          button.addEventListener("click", () => {
            filterButtons.forEach((btn) => btn.classList.remove("active"));
            button.classList.add("active");

            const filter = button.getAttribute("data-filter");

            projects.forEach((project) => {
              const category = project.getAttribute("data-category");
              if (filter === "all" || filter === category) {
                project.style.display = "block";
              } else {
                project.style.display = "none";
              }
            });
          });
        });

        // Enhanced responsive video layout system
        const videoContainers = document.querySelectorAll(".project-video");

        videoContainers.forEach((container) => {
          container.addEventListener("click", function (e) {
            e.preventDefault();

            // Prevent multiple clicks
            if (
              this.classList.contains("playing") ||
              this.classList.contains("loading")
            )
              return;

            const videoUrl = this.getAttribute("data-video");
            if (!videoUrl) return;

            // Add loading state
            this.classList.add("loading");
            const originalHeight = this.offsetHeight;

            // Create video element based on URL type
            if (
              videoUrl.includes("vimeo.com") ||
              videoUrl.includes("player.vimeo.com")
            ) {
              handleVimeoVideo(this, videoUrl, originalHeight);
            } else {
              handleDirectVideo(this, videoUrl, originalHeight);
            }
          });
        });

        function handleVimeoVideo(container, videoUrl, originalHeight) {
          // Create iframe for Vimeo
          const iframe = document.createElement("iframe");

          // Convert to proper embed URL
          let embedUrl = videoUrl;
          if (
            videoUrl.includes("vimeo.com/") &&
            !videoUrl.includes("player.vimeo.com")
          ) {
            const videoId = videoUrl.split("/").pop().split("?")[0];
            embedUrl = `https://player.vimeo.com/video/${videoId}?autoplay=1&loop=1&title=0&byline=0&portrait=0`;
          } else if (!videoUrl.includes("autoplay=1")) {
            embedUrl +=
              (videoUrl.includes("?") ? "&" : "?") + "autoplay=1&loop=1";
          }

          iframe.src = embedUrl;
          iframe.setAttribute("frameborder", "0");
          iframe.setAttribute(
            "allow",
            "autoplay; fullscreen; picture-in-picture"
          );
          iframe.setAttribute("allowfullscreen", "");
          iframe.style.width = "100%";
          iframe.style.height = "100%";
          iframe.style.border = "none";

          // For Vimeo, detect aspect ratio from data attribute or estimate
          iframe.onload = function () {
            setTimeout(() => {
              const dataAspectRatio =
                container.getAttribute("data-aspect-ratio");
              let orientation = "landscape"; // default
              if (dataAspectRatio === "portrait") {
                orientation = "portrait";
              } else if (dataAspectRatio === "square") {
                orientation = "square";
              }
              applyResponsiveLayout(
                container,
                orientation,
                iframe,
                originalHeight
              );
            }, 500); // Small delay to ensure iframe is ready
          };

          setupVideoContainer(container, iframe, originalHeight);
        }

        function handleDirectVideo(container, videoUrl, originalHeight) {
          // Create video element for direct files
          const video = document.createElement("video");
          video.src = videoUrl;
          video.controls = true;
          video.autoplay = true;
          video.loop = true;
          video.style.width = "100%";
          video.style.height = "100%";

          // Wait for metadata to get actual dimensions
          video.addEventListener("loadedmetadata", function () {
            const aspectRatio = this.videoWidth / this.videoHeight;
            let orientation;

            if (aspectRatio > 1.2) {
              orientation = "landscape";
            } else if (aspectRatio < 0.8) {
              orientation = "portrait";
            } else {
              orientation = "square"; // Aspect ratios between 0.8 and 1.2
            }

            applyResponsiveLayout(
              container,
              orientation,
              this,
              originalHeight,
              aspectRatio
            );
          });

          // Fallback if metadata doesn't load
          video.addEventListener("error", function () {
            console.error("Video failed to load:", videoUrl);
            resetVideoContainer(container, originalHeight);
          });

          setupVideoContainer(container, video, originalHeight);
        }

        function setupVideoContainer(container, videoElement, originalHeight) {
          // Remove loading state
          container.classList.remove("loading");
          container.classList.add("playing");

          // Clear container and add video
          container.innerHTML = "";
          container.appendChild(videoElement);
        }

        function applyResponsiveLayout(
          container,
          orientation,
          videoElement,
          originalHeight,
          aspectRatio = null
        ) {
          const project = container.closest(".project");

          // Remove existing layout classes
          container.classList.remove(
            "portrait-mode",
            "landscape-mode",
            "square-mode"
          );
          project.classList.remove(
            "portrait-layout",
            "landscape-layout",
            "square-layout"
          );

          if (orientation === "portrait") {
            container.classList.add("portrait-mode");
            project.classList.add("portrait-layout");

            // Calculate height to maintain aspect ratio
            const maxWidth = 400;
            const calculatedHeight = aspectRatio
              ? maxWidth / aspectRatio
              : maxWidth * 1.77;

            container.style.height = `${Math.min(
              calculatedHeight,
              window.innerHeight * 0.8
            )}px`;
            container.style.maxWidth = `${maxWidth}px`;
            container.style.margin = "0 auto";

            // Ensure video fills container properly
            videoElement.style.objectFit = "contain";
            videoElement.style.width = "100%";
            videoElement.style.height = "100%";
          } else if (orientation === "square") {
            // Square video handling
            container.classList.add("square-mode");
            project.classList.add("square-layout");

            const squareSize = Math.min(container.offsetWidth, 400);
            container.style.height = `${squareSize}px`;
            container.style.width = `${squareSize}px`;
            container.style.margin = "0 auto";

            videoElement.style.objectFit = "cover";
          } else {
            // Landscape video handling
            container.classList.add("landscape-mode");
            project.classList.add("landscape-layout");

            const containerWidth = container.offsetWidth;
            let calculatedHeight;

            if (aspectRatio) {
              calculatedHeight = containerWidth / aspectRatio;
            } else {
              calculatedHeight = containerWidth * (9 / 16);
            }

            calculatedHeight = Math.min(calculatedHeight, 500);
            calculatedHeight = Math.max(calculatedHeight, 250);

            container.style.height = `${calculatedHeight}px`;
            container.style.maxWidth = "100%";
            container.style.margin = "0";

            project.style.maxWidth = "none";
            project.style.justifySelf = "stretch";
          }

          container.style.transition = "all 0.5s ease";
          project.style.transition = "all 0.5s ease";
        }

        function resetVideoContainer(container, originalHeight) {
          const project = container.closest(".project");

          // Reset all classes and styles
          project.classList.remove(
            "portrait-layout",
            "landscape-layout",
            "square-layout"
          );
          container.classList.remove(
            "playing",
            "portrait-mode",
            "landscape-mode",
            "square-mode",
            "loading"
          );
          project.classList.remove("portrait-layout", "landscape-layout");

          // Reset styles
          container.style.height = `${originalHeight}px`;
          container.style.maxWidth = "";
          container.style.margin = "";
          project.style.maxWidth = "";
          project.style.justifySelf = "";

          // Recreate original content
          const aspectRatio = container.getAttribute("data-aspect-ratio");
          const isPortrait = aspectRatio === "portrait";

          container.innerHTML = `
            <div class="thumbnail-container">
              <img src="images/video-thumbnail.jpg" class="video-thumbnail" alt="Video thumbnail">
            </div>
            <div class="ribbon-overlay" style="background: linear-gradient(135deg, ${
              isPortrait ? "#f7dc6f, #f9e79f" : "#45b7d1, #6bd1e8"
            })"></div>
            <div class="video-placeholder">
              ${
                isPortrait ? "Social Media Video" : "Commercial Ad"
              } (Click to play)<br />
              <small>${isPortrait ? "Portrait" : "Landscape"} video</small>
            </div>
          `;
        }

        // Handle window resize to maintain responsive layout
        let resizeTimeout;
        window.addEventListener("resize", function () {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(function () {
            const playingVideos = document.querySelectorAll(
              ".project-video.playing"
            );
            playingVideos.forEach((container) => {
              const orientation = container.classList.contains("portrait-mode")
                ? "portrait"
                : "landscape";
              const videoElement = container.querySelector("video, iframe");
              if (videoElement) {
                const originalHeight = 250; // Default height
                applyResponsiveLayout(
                  container,
                  orientation,
                  videoElement,
                  originalHeight
                );
              }
            });
          }, 250);
        });
      });
    </script>
  </body>
</html>
